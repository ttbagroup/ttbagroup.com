<!doctype html>

{% assign lang=page.lang | default: 'en' %}

<html lang="{{ lang }}" class="no-js">

	{% include head.html %}

	<script type="text/javascript">
		//shim jquery for optimization purposes
		window.$ = window.jQuery = function (x) {
			return {
				ready: function (fn) {
					document.addEventListener('DOMContentLoaded', function (e) {
						fn.call(x, e)
					})
				},
				resize: function (fn) {
					window.addEventListener('resize', function (e) {
						fn.call(x, e)
					})
				},
				load: function (fn) {
					window.addEventListener('load', function (e) {
						fn.call(x, e)
					})
				},
				bind: function () {planJqueryCall('bind', arguments)},
				unbind: function () {planJqueryCall('unbind', arguments)},
				on: function () {planJqueryCall('on', arguments)},
				one: function () {planJqueryCall('one', arguments)},
				off: function () {planJqueryCall('off', arguments)}
			}
		}

		//add plannable method
		var jqueryMethods = 'bind,unbind,on,one,off,focus,click,dblclick,mouseenter,mouseleave,blur,animate,css,hide,show,hover,select,get,post,ajax'.split(',')
		jqueryMethods.forEach(function (method) {
			$[method] = function () {planJqueryCall(method, arguments)}
		})

		var plannedJqueryCalls = []
		function planJqueryCall (name, args) {
			plannedJqueryCalls.push([name, args])
		}
	</script>

	<body class="page{% if page.tilda %} page--tilda{% else %} page--default{% endif %}">
		{% include header.html %}

		<main class="site-content">
			{% if page.tilda == false %}
			<div class="site-content-container">
				<h1>{{ page.title }}</h1>
				{{ content }}
			</div>
			{% else %}
			{{ content }}
			{% endif %}
		</main>

		{% include footer.html %}

		<script type="text/javascript">
			//deshim jquery
			window.$ = window.jQuery = null
		</script>

		{% if page.tilda != false %}
		<link rel="stylesheet" href="/assets/tilda.css" rel="stylesheet" media="screen">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script type="text/javascript">
			//do planned jQuery calls
			for (var i = 0; i < plannedJqueryCalls.length; i++) {
				var name = plannedJqueryCalls[i][0],
					args = plannedJqueryCalls[i][1]
				jQuery[name].apply(jQuery, args)
			}
		</script>
		<script src="/assets/tilda.js"></script>
		{% endif %}

		{% include foot.html %}
	</body>
</html>
